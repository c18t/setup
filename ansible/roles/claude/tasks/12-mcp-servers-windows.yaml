---
- name: 12-mcp-servers-windows | Check installed MCP servers
  ansible.windows.win_shell: claude mcp list
  register: claude_mcp_list
  changed_when: false
  failed_when: false

- name: 12-mcp-servers-windows | Add context7 MCP server
  ansible.windows.win_shell: >-
    claude mcp add --scope user context7 --
    npx -y @upstash/context7-mcp
  when: "'context7' not in claude_mcp_list.stdout"
  register: claude_mcp_add_context7
  changed_when: claude_mcp_add_context7.rc == 0

- name: 12-mcp-servers-windows | Add ccusage MCP server
  ansible.windows.win_shell: >-
    claude mcp add --scope user ccusage --
    npx -y @ccusage/mcp
  when: "'ccusage' not in claude_mcp_list.stdout"
  register: claude_mcp_add_ccusage
  changed_when: claude_mcp_add_ccusage.rc == 0

- name: 12-mcp-servers-windows | Add scopecraft MCP server
  ansible.windows.win_shell: >-
    claude mcp add --scope user scopecraft --
    sc-stdio
  when: "'scopecraft' not in claude_mcp_list.stdout"
  register: claude_mcp_add_scopecraft
  changed_when: claude_mcp_add_scopecraft.rc == 0

- name: 12-mcp-servers-windows | Add typescript MCP server
  ansible.windows.win_shell: >-
    claude mcp add --scope user typescript --
    npx -y @mizchi/lsmcp -p tsgo
  when: "'typescript' not in claude_mcp_list.stdout"
  register: claude_mcp_add_typescript
  changed_when: claude_mcp_add_typescript.rc == 0

- name: 12-mcp-servers-windows | Add go MCP server
  ansible.windows.win_shell: >-
    claude mcp add --scope user go --
    npx -y @mizchi/lsmcp -p gopls
  when: "'go' not in claude_mcp_list.stdout"
  register: claude_mcp_add_go
  changed_when: claude_mcp_add_go.rc == 0
